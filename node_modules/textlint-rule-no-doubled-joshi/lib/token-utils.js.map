{"version":3,"sources":["../src/token-utils.ts"],"names":["is助詞Token","token","test","pos","create読点Matcher","commaCharacters","is読点Token","includes","surface_form","concatToken","aToken","bToken","pos_detail_1","concatJoishiTokens","tokens","newTokens","forEach","prevToken","length","push","createKeyFromKey","pos_detail_2","pos_detail_3","restoreToSurfaceFromKey","key","split"],"mappings":"AAAA;AACA;;;;;;;AAIA;AACO,IAAMA,SAAS,GAAIC,KAAD,IAA0B;AAC/C;AACA,SAAOA,KAAK,IAAI,MAAMC,IAAN,CAAWD,KAAK,CAACE,GAAjB,CAAhB;AACH,CAHM;AAKP;;;;;;;;;AAKO,IAAMC,eAAe,GAAIC,eAAD,IAA+B;AAC1D,SAAO,SAASC,SAAT,CAAmBL,KAAnB,EAAyC;AAC5C,WACII,eAAe,CAACE,QAAhB,CAAyBN,KAAK,CAACO,YAA/B,OACA;AACCP,IAAAA,KAAK,CAACE,GAAN,KAAc,IAAd,IACG;AACAF,IAAAA,KAAK,CAACE,GAAN,KAAc,IAJlB,CADJ;AAOH,GARD;AASH,CAVM;AAWP;;;;;;;;;;AAMA,IAAMM,WAAW,GAAG,CAACC,MAAD,EAAwBC,MAAxB,KAAkD;AAClED,EAAAA,MAAM,CAACF,YAAP,IAAuBG,MAAM,CAACH,YAA9B;AACAE,EAAAA,MAAM,CAACP,GAAP,IAAcQ,MAAM,CAACR,GAArB;AACAO,EAAAA,MAAM,CAACE,YAAP,IAAuBD,MAAM,CAACH,YAA9B;AACA,SAAOE,MAAP;AACH,CALD;AAMA;;;;;;;AAKO,IAAMG,kBAAkB,GAAIC,MAAD,IAA6B;AAC3D,MAAMC,SAA0B,GAAG,EAAnC;AACAD,EAAAA,MAAM,CAACE,OAAP,CAAef,KAAK,IAAI;AACpB,QAAMgB,SAAS,GAAGF,SAAS,CAACA,SAAS,CAACG,MAAV,GAAmB,CAApB,CAA3B;;AACA,QAAIlB,SAAS,CAACC,KAAD,CAAT,IAAoBD,SAAS,CAACiB,SAAD,CAAjC,EAA8C;AAC1CF,MAAAA,SAAS,CAACA,SAAS,CAACG,MAAV,GAAmB,CAApB,CAAT,GAAkCT,WAAW,CAACQ,SAAD,EAAYhB,KAAZ,CAA7C;AACH,KAFD,MAEO;AACHc,MAAAA,SAAS,CAACI,IAAV,CAAelB,KAAf;AACH;AACJ,GAPD;AAQA,SAAOc,SAAP;AACH,CAXM,C,CAYP;AACA;AACA;;;;;AACO,IAAMK,gBAAgB,GAAInB,KAAD,IAA0B;AACtD;AACA;AACA;AACA;AACA,mBAAUA,KAAK,CAACO,YAAhB,cAAgCP,KAAK,CAACE,GAAtC,cAA6CF,KAAK,CAACW,YAAnD,cAAmEX,KAAK,CAACoB,YAAzE,cAAyFpB,KAAK,CAACqB,YAA/F;AACH,CANM,C,CAOP;;;;;AACO,IAAMC,uBAAuB,GAAIC,GAAD,IAAiB;AACpD,SAAOA,GAAG,CAACC,KAAJ,CAAU,GAAV,EAAe,CAAf,CAAP;AACH,CAFM","sourcesContent":["// LICENSE : MIT\n\"use strict\";\n\nimport { KuromojiToken } from \"kuromojin\";\n\n// 助詞どうか\nexport const is助詞Token = (token: KuromojiToken) => {\n    // 結合しているtokenは助詞助詞のようになってるため先頭一致で見る\n    return token && /^助詞/.test(token.pos);\n};\n\n/**\n * 読点を判定する関数を返す\n * 注意: 名詞や記号ではないトークンは読点として扱えない\n * @param commaCharacters\n */\nexport const create読点Matcher = (commaCharacters: string[]) => {\n    return function is読点Token(token: KuromojiToken) {\n        return (\n            commaCharacters.includes(token.surface_form) &&\n            // 、や, は名詞扱い\n            (token.pos === \"名詞\" ||\n                // ，は記号 && 読点となる(surface_formを優先するために pos_detail_1/読点 のチェックを省く)\n                token.pos === \"記号\")\n        );\n    };\n};\n/**\n * aTokenの_extraKeyに結合したkeyを追加する\n * @param {Object} aToken\n * @param {Object} bToken\n * @returns {Object}\n */\nconst concatToken = (aToken: KuromojiToken, bToken: KuromojiToken) => {\n    aToken.surface_form += bToken.surface_form;\n    aToken.pos += bToken.pos;\n    aToken.pos_detail_1 += bToken.surface_form;\n    return aToken;\n};\n/**\n * 助詞+助詞 というように連続しているtokenを結合し直したtokenの配列を返す\n * @param {Array} tokens\n * @returns {Array}\n */\nexport const concatJoishiTokens = (tokens: KuromojiToken[]) => {\n    const newTokens: KuromojiToken[] = [];\n    tokens.forEach(token => {\n        const prevToken = newTokens[newTokens.length - 1];\n        if (is助詞Token(token) && is助詞Token(prevToken)) {\n            newTokens[newTokens.length - 1] = concatToken(prevToken, token);\n        } else {\n            newTokens.push(token);\n        }\n    });\n    return newTokens;\n};\n// 助詞tokenから品詞細分類1までを元にしたkeyを作る\n// http://www.unixuser.org/~euske/doc/postag/index.html#chasen\n// http://chasen.naist.jp/snapshot/ipadic/ipadic/doc/ipadic-ja.pdf\nexport const createKeyFromKey = (token: KuromojiToken) => {\n    // e.g.) \"は:助詞.係助詞.*.*\"\n    // \"しようとすると\" と には次の違いある\n    // と\t助詞\t格助詞\t一般 *\n    // と\t助詞\t接続助詞\t*\t*\n    return `${token.surface_form}:${token.pos}.${token.pos_detail_1}.${token.pos_detail_2}.${token.pos_detail_3}`;\n};\n// keyからsurfaceを取り出す\nexport const restoreToSurfaceFromKey = (key: string) => {\n    return key.split(\":\")[0];\n};\n"],"file":"token-utils.js"}